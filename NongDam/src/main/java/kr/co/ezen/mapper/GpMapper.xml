<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="kr.co.ezen.mapper.GpMapper">
	
		<sql id="search">
			<if test="type == 'progress'">
				where gp_title like concat('%',#{keyword},'%')
			</if>
			<if test="type == 'complet'">
				where gp_title like concat('%',#{keyword},'%')
			</if>
		</sql>
		
		<select resultType="kr.co.ezen.entity.Gp" id="findAll"
			parameterType="kr.co.ezen.entity.Criteria">
			select gp_title, gp_date, gp_date_start, gp_date_last, gp_idx, gp_thumb from gp
			<include refid="search"/>
			order by gp_idx
		 	limit #{pageStart}, #{perPageNum}	
		</select> 
		
		<select id="totalCount" resultType="int" parameterType="kr.co.ezen.entity.Criteria">
		   select count(*) from gp
		   <include refid="search"/>
		</select>
		
		<select resultType="kr.co.ezen.entity.Gp" 
		parameterType="int" id="findByIdx">
			select gp_title, gp_price, gp_date_start, gp_date_last, gp_content, gp_idx, gp_thumb from gp
			where gp_idx=#{gp_idx}
		</select>
		
		<insert id="insert" parameterType="kr.co.ezen.entity.Gp">
			insert into Gp (gp_title,gp_content,gp_price,gp_date_start, gp_date_last, gp_thumb)
			VALUES (#{gp_title}, #{gp_content},#{gp_price},#{gp_date_start},#{gp_date_last},#{gp_thumb})
		</insert>
		
		
		<update id="updateByIdx" parameterType="kr.co.ezen.entity.Gp">
			update gp set gp_title=#{gp_title}, gp_content=#{gp_content}, gp_price=#{gp_price}, gp_date_start=#{gp_date_start}, gp_date_last=#{gp_date_last}, gp_thumb=#{gp_thumb}
			where gp_idx=#{gp_idx}
		</update>
		
		
		<delete id="deleteByIdx" parameterType="int">
			delete from gp where gp_idx=#{gp_idx}
		</delete>

	</mapper>